\usepackage{setspace}
\usepackage{url}
\usepackage{graphicx}
\usepackage{tocloft}
\usepackage{color}
\usepackage{scrextend}
\usepackage{titletoc}
\usepackage{sectsty}
\usepackage{fancyhdr}
\usepackage{xspace}
\usepackage{glossaries}
\usepackage[hmargin=1.5in, vmargin=1.5in]{geometry}

\sectionfont{\normalsize}
\subsectionfont{\normalsize}
\subsubsectionfont{\normalsize}

\newcommand{\const}[2]{%
\expandafter\newcommand\csname #1\endcsname{#2\xspace}%
}

\newcommand{\UwLocation}{Waterloo, Ontario}

\newlength\mylen
\settowidth\mylen{Figure\ }
\addtolength\cftfignumwidth{\mylen}
\addtolength\cfttabnumwidth{\mylen}
\renewcommand*{\cftfigfont}{Figure }
\renewcommand*{\cfttabfont}{Table \hspace{0.075in}}

\doublespacing
\addtolength{\parskip}{\baselineskip}
\setlength{\parindent}{0pt}
\setlength{\cftsecnumwidth}{25pt}
\setlength{\parskip}{1em}

\newcommand{\waterlootitlepage}[4] {

\titlecontents{section}
[0pt]
{}%
{\contentsmargin{0pt}
    \thecontentslabel\enspace%
    }
    {\contentsmargin{0pt}}
    {\titlerule*[.5pc]{.}\contentspage}
    []

    \begin{singlespace}
    \begin{titlepage}
    \begin{center}
    \textbf{\MakeUppercase{University of Waterloo}} \\
    #1
    \vfill
    {
    \textbf{\MakeUppercase{#2}}
    }
    \vfill
    #3
    \vfill
    Prepared by \\
    \vspace{5mm}
    #4
    \end{center}
    \end{titlepage}
    \end{singlespace}


    }

    \newcommand{\waterlooletterofsubmittal}[7] {
    \begin{waterlooletter}
    #1 \\
    #2 \\
    #3 \\ \\
    \today \\ \\
    Mr. Jeff Chen, Department Chair \\
    Department of Physics and Astronomy \\
    University of Waterloo \\
    200 University Avenue West \\
    Waterloo, Ontario \\
    N2L 3G1 \\ \\
    Dear Mr. Chen: \\

    #6

    Sincerely, \\ \\
    #7 \\
    #4 \\
    ID #5
    \end{waterlooletter}
    }

    \newenvironment{waterlooletter}{
    \begin{singlespace}}{
    \end{singlespace}
    \thispagestyle{empty}
    \newpage
    }

    \makeatletter
    \renewcommand\@biblabel[1]{#1} % No brackets for the references
    \renewenvironment{thebibliography}[1]
         {\section*{\refname}%
          \@mkboth{\MakeUppercase\refname}{\MakeUppercase\refname}%
          \list{\@biblabel{\@arabic\c@enumiv}}%
               {\settowidth\labelwidth{\@biblabel{#1}}%
                \leftmargin\labelwidth
                \advance\leftmargin20pt% change 20 pt according to your needs
                \advance\leftmargin\labelsep
                \setlength\itemindent{-20pt}% change using the inverse of the length used before
                \@openbib@code
                \usecounter{enumiv}%
                \let\p@enumiv\@empty
                \renewcommand\theenumiv{\@arabic\c@enumiv}}%
          \sloppy
          \clubpenalty4000
          \@clubpenalty \clubpenalty
          \widowpenalty4000%
          \sfcode`\.\@m}
         {\def\@noitemerr
           {\@latex@warning{Empty `thebibliography' environment}}%
          \endlist}
    \renewcommand\newblock{\hskip .11em\@plus.33em\@minus.07em}
    \makeatother

    \newcommand{\makereferences}[1]{
    \newpage
    \addcontentsline{toc}{section}{References}
    \begin{thebibliography}{99\kern\bibindent}
    #1
    \end{thebibliography}
    \newpage
    }

    \newcommand{\placeglossary}{
    \newpage
    \addcontentsline{toc}{section}{Glossary}
    \printnoidxglossaries
    \newpage
    }

    \newcommand{\completeditem}{
    \item $\left[ Y \right]$
    }

    \newcommand{\addchecklistappendix}{
    Your report must:
    \begin{itemize}
    \completeditem Include 4-6 pages of body content. Figures or tables that are included in the body are excluded in the 4-6 page count. (Example: 8 pages of content that includes a one-page figure and a half-page table counts as 6.5 pages of body content.)  Adherence to the 3Cs (clarity, conciseness, and coherence) will allow you to meet this page limit.
    \completeditem Include at least one table (Place the table in the body of your report if you discuss it in detail; place the table in an appendix if your analysis refers to it only briefly.)
    \completeditem Include at least one figure (Place the figure in the body of your report if you discuss it in detail; place the figure in an appendix if your analysis refers to it only briefly.)
    \completeditem Use a 12-point serif font
    \completeditem Be double-spaced
    \completeditem Be written in formal, standard English, with no contractions
    \completeditem Be spellchecked and proofread
    \completeditem Include pages numbered according to the conventions described in the Report Resources tab.
    \end{itemize}
    Your report must conform to the format and conventions described in the Report Resources page. You do not have to bind your report or include a front cover because you will submit your report to us online. Your report will include the following pages and sections:
    \begin{itemize}
    \completeditem Title page
    \completeditem Letter of submittal (addressed to the PD 2 course instructor)
    \completeditem Table of contents
    \completeditem List of figures and tables, if appropriate (Figures or tables in an appendix should not be listed on the List of figures and tables; figures or tables elsewhere in your report are required to bbe on this list.)
    \completeditem Summary
    \completeditem Introduction
    \completeditem Body (that includes both an objective analytical component and a reflective component)
    \completeditem Conclusions (the section is "conclusions" as in "findings", not "conclusion")
    \completeditem Recommendations (specific, measurable, and attainable)
    \completeditem References
    \completeditem Appendices (you need at least one appendix which includes this checklist)
    \end{itemize}
    }

    \newcommand{\conclusion}[2]{
        \emph{#1} \\
        #2 \\ \\
    }

    \newcommand{\recommendation}[2]{
        \emph{#1} \\
        #2 \\ \\
    }

    \newcommand{\addanappendix}[2]{
    \tocsection{#1}
    #2
    }

    \makeatletter
    \renewcommand\ext@table{lof}
    \makeatother

    \renewcommand\cftfigpresnum{Figure }
    \renewcommand\cfttabpresnum{Table }

    \newcommand{\mytableofcontents} {
    \tableofcontents
    \newpage
    \begin{center}
    \tocsection{List of Tables and Figures}
    \end{center}
    \listoffigures
    \newpage
    }

    \newcommand{\mySection}[2] {
    \section{#1}
    #2
    }

    \newcommand{\mySubSection}[2] {
    \begin{addmargin}[1.5em]{0em}
    \subsection{#1}
    #2
    \end{addmargin}
    }

    \newcommand{\mySubSubSection}[2] {
    \begin{addmargin}[1.5em]{0em}
    \subsubsection{#1}
    #2
    \end{addmargin}
    }

    \newcommand{\myFigure}[3] {
    \begin{figure}
    \centering
    \scalebox{#1}{\includegraphics{#2}}
    \caption{#3}
    \end{figure}
    }

    \newcommand{\mySVGFigure}[3] {
    \begin{figure}
    \centering
    \scalebox{#1}{\includegraphics{#2}}
    \caption{#3}
    \end{figure}
    }

    \newcommand{\myTable}[3] {
    \begin{table}
    \centering
    \scalebox{#1}{\includegraphics{#2}}
    \caption{#3}
    \end{table}
    }

    \def\thesection{\arabic{section}.0 }
    \def\thesubsection{\arabic{section}.\arabic{subsection}}

    \renewcommand{\contentsname} {
    \begin{center}
    Table of Contents
    \end{center}
    }

    \newcommand{\bulletpoints}[1]{
    \begin{spaceditemize}
    #1
    \end{spaceditemize}
    }

    \renewcommand{\listfigurename}{}
    \renewcommand{\cftsecleader}{\bfseries\cftdotfill{\cftdotsep}}
    \renewcommand{\cftfigpresnum}{Figure }
    \renewcommand{\cftfigaftersnum}{ --- }
    \renewcommand{\cftfignumwidth}{65pt}
    \newcommand{\tocsection}[1]{
    \section*{#1}
    \addcontentsline{toc}{section}{#1}
    }

    \newenvironment{spaceditemize}{
    \begin{list}{$\bullet$}
    {
    \setlength{\parskip}{0pt}
    }}
    {\end{list}\bigskip
    }



